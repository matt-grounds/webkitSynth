(function(b){var a={init:function(c){var d=b.extend({classes:["rot-knob"],frameCount:64,frameWidth:64,frameHeight:64,minimumValue:-100,maximumValue:100,detent:false,detentValue:0,detentThreshold:10,discreteSteps:false,stepCount:2,dragVertical:true,invertDirection:false,dragMultiplier:1,animationFPS:25,hideInput:false,hideRealValue:true,isToggle:true,callback:function(){}},c);b("body").data("knobRot",{dragging:false});a.addCssStyles();return this.each(function(){if(d.minimumValue>=d.maximumValue){}else{if(d.discreteSteps==true&&d.stepCount<=1){throw"Knob range error: Maximum value must be greater than minimum value.";throw"Invalid step count: Discrete knob must have a minimum of 2 steps."}}var j=b(this);j.callback=d.callback;j.attr("autocomplete","off");if(j.is("input:text")){var k=b("<input>",{type:"text",value:parseFloat(j.val()),});k.attr("autocomplete","off");k.data("knobRot",{settings:d,outputField:j});j.after(k);k.data("knobRot").rangeSize=d.maximumValue-d.minimumValue;k.data("knobRot").rangeOffset=0-d.minimumValue;if(d.discreteSteps==true){k.data("knobRot").stepIncrement=(d.maximumValue-d.minimumValue)/(d.stepCount-1)}k.data("knobRot").calculatedValue=a.calculateValue(k);k.data("knobRot").currentFrame=a.calculateFrame(k);k.data("knobRot").dirtyData=true;var i=1000/d.animationFPS;var g=d.classes.slice();g[g.length]="rot-knob-base";var h=j.attr("name");if(typeof(h)=="undefined"){h="unnamed"}var f=j.attr("id");if(typeof(f)=="undefined"){f="noid"}g[g.length]="for-input-"+h+"-"+f;var e=b("<div>",{"class":g.join(" ")});e.data("knobRot",{realValue:k,outputField:j});k.data("knobRot").knobDiv=e;j.data("knobRot",{knob:e,realValue:k});e.css({width:d.frameWidth+"px",height:d.frameHeight+"px","background-position":a.calculateBackgroundOffsetX(k)+"px 0px",cursor:a.getDragCursorClass(k)});e.on("mousedown.knobRot",function(m){if(m.which!=1){return}$knobDiv=b(this);if(b("body").data("knobRot").dragging!=true){var l={left:m.screenX,top:m.screenY};$knobDiv.addClass("dragging");b("body").data("knobRot").dragging=true;b("body").data("knobRot").lastOffset=l;b("body").data("knobRot").knobDiv=$knobDiv;b("body").addClass(a.getDragCursorClass($knobDiv.data("knobRot").realValue));$knobDiv.data("knobRot").outputField.trigger("knobdragstart",$knobDiv)}});b(document).on("mousemove.knobRot",function(m){if(b("body").data("knobRot").dragging==true){var l={horizontal:m.screenX-b("body").data("knobRot").lastOffset.left,vertical:m.screenY-b("body").data("knobRot").lastOffset.top};b("body").data("knobRot").lastOffset={left:m.screenX,top:m.screenY};a.updateValue(b("body").data("knobRot").knobDiv.data("knobRot").realValue,l);b("body").data("knobRot").knobDiv.data("knobRot").outputField.trigger("knobrefresh",b("body").data("knobRot").knobDiv);b("body").data("knobRot").knobDiv.data("knobRot").outputField.trigger("knobdrag",b("body").data("knobRot").knobDiv)}});b(document).on("mouseup.knobRot",function(){a.stopDrag()});b("body").on("selectstart.knobRot select.knobRot mousedown.knobRot mouseover.knobRot",function(){if(b("body").data("knobRot").dragging==true){return false}});j.on("knobrefresh.knobRot",function(){j.callback();k.data("knobRot").dirtyData=true});e.on("mouseover.knobRot mouseout.knobRot mouseup.knobRot",function(){e.data("knobRot").outputField.trigger("knobrefresh",e)});e.on("mouseover",function(){j.addClass("hover");var l=a.getDragCursorClass(e.data("knobRot").realValue);e.addClass(l);e.data("knobRot").outputField.trigger("knobmouseover",e)});e.on("mouseout",function(){j.removeClass("hover");var l=a.getDragCursorClass(e.data("knobRot").realValue);e.removeClass(l);e.data("knobRot").outputField.trigger("knobmouseout",e)});k.after(e);setInterval(function(){a.updateCallback(k)},i);if(d.hideInput==true){j.hide()}if(d.hideRealValue==true){k.hide()}j.attr("disabled","disabled");j.attr("unselectable","on");j.on("mousedown",function(){return false});j.on("mouseover",function(){return false});j.trigger("knobrefresh",e);j.trigger("knobready",e)}})},getvalue:function(){$this=b(this);if($this.is("input:text")){if($this.data("knobRot")){return $this.data("knobRot").calculatedValue}else{throw'Can not call "value" on a non-knobRot element'}}else{throw"Not a valid input element for knobRot.getvalue"}},set:function(c){return b(this).each(function(){var d=b(this);if(d.is("input:text")){d.data("knobRot").realValue.val(parseFloat(c));d.data("knobRot").realValue.trigger("knobrefresh")}})},calculateStep:function(c){var f=c.data("knobRot");var d=f.settings;if(d.discreteSteps){var g=parseFloat(c.val())+f.rangeOffset;var e=g/f.rangeSize;var h=Math.round(e*(d.stepCount-1));return h}else{throw"Unable to calculate discrete step offset for non-discrete knob."}},calculateValue:function(c){var g=c.data("knobRot");var d=g.settings;if(d.discreteSteps==true){var f=a.calculateStep(c);var e=f*g.stepIncrement-g.rangeOffset}else{var e=parseFloat(c.val())}if(d.detent==true&&e>=d.detentValue-d.detentThreshold&&e<=d.detentValue+d.detentThreshold){if(c.data("knobRot").calculatedValue!=e&&(c.data("knobRot").calculatedValue<d.detentValue-d.detentThreshold||c.data("knobRot").calculatedValue>d.detentValue+d.detentThreshold)){c.data("knobRot").outputField.trigger("knobenterdetent",c.data("knobRot").knobDiv)}e=d.detentValue}else{if(c.data("knobRot").calculatedValue==d.detentValue&&c.data("knobRot").calculatedValue!=e&&e!=d.detentValue){c.data("knobRot").outputField.trigger("knobleavedetent",c.data("knobRot").knobDiv)}}if(e<d.minimumValue){c.val(d.minimumValue);c.data("knobRot").outputField.trigger("knobvaluemin",c.data("knobRot").knobDiv);return d.minimumValue}else{if(e>d.maximumValue){c.val(d.maximumValue);c.data("knobRot").outputField.trigger("knobvaluemax",c.data("knobRot").knobDiv);return d.maximumValue}}return e},calculateFrame:function(c){var h=c.data("knobRot");var d=h.settings;var e=a.calculateValue(c)+h.rangeOffset;var f=e/h.rangeSize;var g=Math.round(f*(d.frameCount-1));if(g>(d.frameCount-1)){return(d.frameCount-1)}else{if(g<0){return 0}}if(c.data("knobRot").currentFrame!=g){c.data("knobRot").outputField.trigger("knobframechange",[h,c.data("knobRot").currentFrame,g])}return g},calculateBackgroundOffsetX:function(c){var e=c.data("knobRot");var d=e.settings;return 0-a.calculateFrame(c)*d.frameWidth},updateCallback:function(c){if(c.data("knobRot").dirtyData==true){c.data("knobRot").dirtyData=false;c.data("knobRot").knobDiv.css("background-position",a.calculateBackrgroundOffset(c));c.data("knobRot").calculatedValue=a.calculateValue(c);c.data("knobRot").outputField.val(c.data("knobRot").calculatedValue);c.data("knobRot").outputField.data("knobRot").calculatedValue=c.data("knobRot").calculatedValue}},stopDrag:function(){if(b("body").data("knobRot").dragging==true){var c=b("body").data("knobRot").knobDiv;b("body").data("knobRot").dragging=false;c.removeClass("dragging");b("body").removeClass(a.getDragCursorClass(c.data("knobRot").realValue));c.data("knobRot").outputField.trigger("knobrefresh")}},updateValue:function(c,d){var g=0;if(c.data("knobRot").settings.dragVertical){g=d.vertical}else{g=d.horizontal}g=g*c.data("knobRot").settings.dragMultiplier;if((!c.data("knobRot").settings.invertDirection&&c.data("knobRot").settings.dragVertical==true)||(c.data("knobRot").settings.invertDirection&&c.data("knobRot").settings.dragVertical==false)){g=0-g}var e=parseFloat(c.val());var f=e+g;if(f>c.data("knobRot").settings.maximumValue){f=c.data("knobRot").settings.maximumValue}else{if(f<c.data("knobRot").settings.minimumValue){f=c.data("knobRot").settings.minimumValue}}c.val(f)},calculateBackrgroundOffset:function(d){var c=a.calculateBackgroundOffsetX(d)+"px";var e="0px";if(d.data("knobRot").outputField.hasClass("hover")&&b("body").data("knobRot").dragging==false){e=(0-d.data("knobRot").settings.frameHeight)+"px"}if(b("body").data("knobRot").dragging==true&&d.is(b("body").data("knobRot").knobDiv.data("knobRot").realValue)){e=(0-d.data("knobRot").settings.frameHeight*2)+"px"}return c+" "+e},getDragCursorClass:function(c){if(c.data("knobRot").settings.dragVertical==true){return"rotknob-n-resize"}else{return"rotknob-e-resize"}},addCssStyles:function(){var c=b('<style type="text/css" rel="stylesheet">	.rotknob-n-resize{ cursor: n-resize!important; }	.rotknob-e-resize{ cursor: e-resize!important; }</style>').appendTo("body")}};b.fn.knobRot=function(c){if(a[c]){return a[c].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof c==="object"||!c){return a.init.apply(this,arguments)}else{b.error("Method "+c+" does not exist on jQuery.knobRot")}}}})(jQuery);